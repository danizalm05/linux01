                Nmap (Network Mapper)
========================================================		
 MAN PAGE (https://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES					   
https://tryhackme.com/room/furthernmap
https://github.com/technorraj/tryhackme.com-room-furthernmap	
		
network detection and security scanning utility ,port scanning tool

nmap [<Scan Type>] [<Options>] {<target specification>}

EXAMPLES:
  nmap -sC -sV -oN  outresult.txt <IP> 

  
  
  nmap -sV <ip>
  
  nmap -sV --script vuln -v <IP>
  -sV : scans for the versions of discovered services.
  --script :Scripting Engine.
  vuln :Investigate vulnerabilities or exploit vulnerable servic



  nmap -sC -sV -vvv   <IP>
  sudo nmap -vv -sS    --script vuln <IP>
   -vv:  very verbose
   -sS: syn scan 
   --script vuln: check for vlunnerabilities
  
  nmap -p80,139,445,10000,20000 -A 192.168.1.205# Scan ports 80, 139 ....
  nmap -v -A scanme.nmap.org
  nmap -v -sn 192.168.0.0/16 10.0.0.0/8
  nmap -v -iR 10000 -Pn -p 80


  nmap -sC -sV -oN   <file name to store> <ip>  #Store results in a file    
    -sV parameter for version information 
    -sC parameter for script information. 
    To make the scan faster, we can included the -T4 



-p <x> or -p- 	Port scan for port <x> or scan all ports (Ex:p-400 scan 400)
-Pn 	Disable host discovery and scan for open ports
-A 	Enables OS and version detection, executes in-build scripts for further enumeration 
-sC 	Scan with the default Nmap scripts
-v 	Verbose mode
-sU 	UDP port scan
-sS 	TCP SYN port scan



Basic Scanning Techniques
=======================

Scan a single target : nmap [target]
"   multiple targets: nmap [target1,target2,etc]
"   a list of targets: nmap -iL [list.txt]
"   a range of hosts: nmap [range of IP addresses]
"   an entire subnet: nmap [IP address/cdir]

Perform an aggressive scan: nmap -A [target]

        Discovery Options
       ===================== 
Perform a ping scan only	nmap -sP [target]
Don’t ping	nmap -PN [target]
TCP SYN Ping	nmap -PS [target]
TCP ACK ping	nmap -PA [target]
UDP ping	nmap -PU [target]
SCTP Init Ping	nmap -PY [target]
ICMP echo ping	nmap -PE [target]
ICMP Timestamp ping	nmap -PP [target]
ICMP address mask ping	nmap -PM [target]
IP protocol ping	nmap -PO [target]
ARP ping	nmap -PR [target]
Traceroute	nmap –traceroute [target]
Force reverse DNS resolution	nmap -R [target]
Disable reverse DNS resolution	nmap -n [target]
Alternative DNS lookup	nmap –system-dns [target]
Manually specify DNS servers	nmap –dns-servers [servers] [target]
Create a host list	nmap -sL [targets]


                           Version Detection
						   ======================
Operating system detection	nmap -O [target]
Attempt to guess an unknown	nmap -O –osscan-guess [target]
Service version detection	nmap -sV [target]
Troubleshooting version scans	nmap -sV –version-trace [target]
Perform a RPC scan	nmap -sR [target]
                           Output Options
						=============================   
Save output to a text file	nmap -oN [scan.txt] [target]
Save output to a xml file	nmap -oX [scan.xml] [target]
Grepable output	nmap -oG [scan.txt] [target]
Output all supported file types	nmap -oA [path/filename] [target]
Periodically display statistics	nmap –stats-every [time] [target]
133t output	nmap -oS [scan.txt] [target]						   
						   
						   
https://tryhackme.com/room/furthernmap

https://github.com/technorraj/tryhackme.com-room-furthernmap		

Nmap Switches

-sS    The first switch listed in the help menu for a SYN scan?
-sU    switch for a UDP scan?
-O     detects the operating system?
-sV    detects the version of services?
-v     to increase verbosity?
-vv    set verbosity level to two?
-oA    Save results in all formats?
-oN    Save results in normal format?
-oG    Save results in grepable format?
-A     Enable aggressive mode  ( OS detection, version detection, script scanning, and traceroute)
-T5    Set timing template to level 5  used to increase the speed your scan runs at. 
         But higher speeds are  noisier, and can incur errors!
-p 80  Scan only port 80 
-p 1000-1500   Scan ports 1000–1500?
-p-     Scan all ports?
--script  Activate a script from the library?
--script=vuln  Activate all scripts in the "vuln" category


port scanning with Nmap
-----------------------------
1    TCP Connect Scans (-sT) :  Nmap tries to connect to each specified TCP port, and determines
  whether the service is open by the response it receives.
If  it respond with a TCP packet with the RST (Reset) flag set.   Nmap can establish that the port is closed.
If, however, the request is sent to an open port, the target will respond with a TCP packet with 
the SYN/ACK flags set. Nmap then marks this port as being open .

                    TCP scans   stages  
				======================================	  
            A. connecting terminal sends  SYN flag .
            B.  server acknowledges  sends the SYN flag and   ACK flag.  
            C. connecting terminal  sends   ACK flag.

2    SYN Scans (-sS) : referred to as "Half-open" scans, or "Stealth" scans.

                    SYN Scans   stages  
	           ======================================
            A. connecting terminal sends  SYN flag .
            B.  server acknowledges  sends the SYN flag and   ACK flag.  
            C. connecting terminal  sends   RST  flag.


		  

3 UDP Scans (-sU)   UDP connections rely on sending packets to a target port and essentially
  hoping that they make it. 
  If a UDP port doesn't respond to an Nmap scan,  it be marked as   open|filtered 

less common port scan types
---------------------------------
  NULL, FIN and Xmas scans generally used for Firewall evasion

 1.   TCP Null Scans (-sN): TCP request is sent with no flags set at all. 
          The target host should respond with a RST if the port is closed.
 2.   TCP FIN Scans (-sF)
 3,   TCP Xmas Scans (-sX)


 ICMP Network Scanning
 ------------------------
 ping sweep". 
 Nmap sends an ICMP packet to each possible IP address for the specified network. 
 When it receives a response, it marks the IP address that responded as being alive
 
     nmap -sn 192.168.0.1-254  or nmap -sn 192.168.0.0/24
 
				   