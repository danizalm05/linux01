
                               Eavesdrop   
					 --------------------------------------		  
                         

problem URL: 
https://play.picoctf.org/practice/challenge/264
https://www.youtube.com/watch?v=Sb5PS-DddXY&list=PL1H1sBF1VAKUbRWMCzEBi61Z_7um7V5Sd&index=46


https://tzion0.github.io/ctf/picoctf-for/
https://github.com/KathleenX7/PicoCTF-2022-Writeup/blob/main/Forensics/Eavesdrop/README.md
https://medium.com/@kautsar.muwahhid/picoctf-write-up-eavesdrop-a26aeaa4b9cc


Description
  Download this packet capture :
           'https://artifacts.picoctf.net/c/135/capture.flag.pcap'
  and find the flag
 
Hints:
  All we know is that this packet capture includes a chat conversation 
  and a file transfer.
  
 
Solution:
  1. wget   https://artifacts.picoctf.net/c/135/capture.flag.pcap
  2. file  capture.flag.pcap
     output:
    	capture.flag.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 
	    (Ethernet, capture length 262144)

  3. strings capture.flag.pcap
     output:
        among the mant lines next one is interesting 
	      '*sigh* openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123'
	    this command translater 'file.des3' to 'file.txt'
		So we can't run it becase the file 'file.des3' does not exists. 

	 note:
	      3DES is an encryption  a symmetric-key algorithm both for encryption and decryption. 
	
	 The next lines in the ouput are importent too.
	    a. 'gCould you transfer the file to me again?'
        b. 'Oh great. Ok, over 9002?'
		
  4. start wireshark 
	     wireshark capture.flag.pcap
	 you can do the process in stage 2 by  right click on the TCP line and chose Flow.	
	 On port 9001, there's conversations happening in the TCP stream so right click,
	 Follow > TCP Stream for one of the packets on port 9001:
	  Output:
	        --------------------------------------------
			Hey, how do you decrypt this file again?
			You're serious?
			Yeah, I'm serious
			*sigh* openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123
			Ok, great, thanks.
			Let's use Discord next time, it's more secure.
			C'mon, no one knows we use this program like this!
			Whatever.
			Hey.
			Yeah?
			Could you transfer the file to me again?
			Oh great. Ok, over 9002?
			Yeah, listening.
			Sent it
			Got it.
			You're unbelievable
            ------------------------------------------------
			
 5.
 By increasing the TCP Stream to 2,( in the url window write 
   'tcp.stream eq 2')
    we can see a stream starting with Salted_			
	'Salted__<K&....,J.......o..%....I{97X...........'		

  another way to do that is :
      right click on a coulmn and chose column prefence
	  press + to add a new cloumn. Change the name to Src port.
	  change type to    'source port'
	  Add another port Change the name to Dst port.
	  change type to    'destination port'
	
	  look in the source dst clomn for port 9002
	  right click and chose flow
	  the screen will show  'Salted__<K&....,J.......o..%....I{97X...........'
			
6. After that, change the value of field Show and save data as to raw, 
    then click Save as	and chose the file name	'fil.des3'	
			
7. Next, apply the command we noted down before to decrypt the file we saved 
 just now:			
	 openssl des3 -d -salt -in fil.des3 -out file.txt -k supersecretpassword123		
8. run 'more file.txt'			
	output 	  picoCTF{nc_73115_411_0ee7267a}	

