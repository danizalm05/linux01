
                              ropfu
					 -------------------------------------	
NO SOULOTION 					 
 Return Oriented Programming (ROP):  
 chaining together small snippets of assembly with stack control to cause the program to do more complex things.                      

problem URL: 
https://play.picoctf.org/practice/challenge/292 
https://www.youtube.com/watch?v=c7wNN8qgxAA&list=PL1H1sBF1VAKUbRWMCzEBi61Z_7um7V5Sd&index=48

https://cahgames.github.io/writeups/2022/04/04/ropfu.html


Description
  What's ROP?
  Can you exploit the following program:
       https://artifacts.picoctf.net/c/43/vuln  
  to get the flag? 
  Download source:
       https://artifacts.picoctf.net/c/43/vuln.c

Additional details will be available after launching your challenge instance.
    nc saturn.picoctf.net 62428
Hints:
   This is a classic ROP to get a shell
   
Sourc code:
 ------------------------------------------------------
#define BUFSIZE 16

void vuln() {
  char buf[16];
  printf("How strong is your ROP-fu? Snatch the shell from my hand, grasshopper!\n");
  return gets(buf);

}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  

  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  vuln();
  
}  
 --------------------------------------
 
 
 
Solution:
   1. wget  https://artifacts.picoctf.net/c/43/vuln 
      wget  https://artifacts.picoctf.net/c/43/vuln.c
      chmod+x vuln
    2. gdb  vuln
    3 b *main    # add break point 
	   output:
	       gef➤  b *main
           Breakpoint 1 at 0x8049dc1
    4.  gef➤r   # run the program
	
	
	picoCTF{}


